const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/chunk-BJ_koBnH.js","js/chunk-Bkkzv6j4.js"])))=>i.map(i=>d[i]);
import{_ as e}from"./chunk-uNZoKFSG.js";import{d as s}from"./index-B4sOzZkQ.js";import{m as t,n}from"./chunk-SPeBi8oJ.js";import"./chunk-BXGe81IW.js";import"./chunk-rj-8a6OE.js";import"./chunk-Bkkzv6j4.js";import"./chunk-Do_hQOja.js";const i=new class{constructor(){this.isServer="undefined"==typeof window,this.twilio=null,this.settings=null}async loadSettings(){if(this.isServer)try{const r=await t(n(s,"settings","general"));if(r.exists()){const s=r.data();if(this.settings={enableSMS:s.enableSMS||!1,twilioAccountSid:s.twilioAccountSid||"",twilioAuthToken:s.twilioAuthToken||"",twilioPhoneNumber:s.twilioPhoneNumber||"",senderName:s.senderName||"SBS Transfer"},this.settings.twilioAccountSid&&this.settings.twilioAuthToken)try{const s=(await e(async()=>{const{default:e}=await import("./chunk-BJ_koBnH.js").then(e=>e.i);return{default:e}},__vite__mapDeps([0,1]))).default;this.twilio=new s(this.settings.twilioAccountSid,this.settings.twilioAuthToken)}catch(i){}}}catch(i){}}async sendReservationConfirmation(e){if(!this.isServer)return{success:!1,message:"SMS gÃ¶nderimi sadece server-side desteklenir"};if(this.settings||await this.loadSettings(),!this.settings?.enableSMS)return{success:!1,message:"SMS gÃ¶nderimi kapalÄ±"};const s=this.createReservationMessage(e);return await this.sendSMS(e.customerPhone,s)}async sendPaymentConfirmation(e){if(!this.isServer)return{success:!1,message:"SMS gÃ¶nderimi sadece server-side desteklenir"};if(this.settings||await this.loadSettings(),!this.settings?.enableSMS)return{success:!1,message:"SMS gÃ¶nderimi kapalÄ±"};const s=this.createPaymentMessage(e);return await this.sendSMS(e.customerPhone,s)}async sendDriverInfo(e,s){if(!this.isServer)return{success:!1,message:"SMS gÃ¶nderimi sadece server-side desteklenir"};if(this.settings||await this.loadSettings(),!this.settings?.enableSMS)return{success:!1,message:"SMS gÃ¶nderimi kapalÄ±"};const t=this.createDriverInfoMessage(e,s);return await this.sendSMS(e.customerPhone,t)}async sendSMS(e,s){if(!this.isServer)return{success:!1,message:"SMS gÃ¶nderimi browser'da desteklenmiyor"};try{if(!this.twilio)throw new Error("Twilio ayarlarÄ± eksik");if(!this.settings?.twilioPhoneNumber)throw new Error("Twilio telefon numarasÄ± ayarlanmamÄ±ÅŸ");const t=this.formatPhoneNumber(e);return{success:!0,messageId:(await this.twilio.messages.create({body:s,from:this.settings.twilioPhoneNumber,to:t})).sid,message:"SMS baÅŸarÄ±yla gÃ¶nderildi"}}catch(t){return{success:!1,error:t.message,message:"SMS gÃ¶nderilemedi"}}}formatPhoneNumber(e){if(!e)return"";let s=e.replace(/\D/g,"");return s.startsWith("0")?s="90"+s.substring(1):s.startsWith("90")||(s="90"+s),"+"+s}createReservationMessage(e){return`ğŸ‰ ${this.settings?.senderName||"SBS Transfer"}\n\nâœ… Rezervasyonunuz onaylandÄ±!\n\nğŸ“‹ No: ${e.reservationNumber}\nğŸ“… Tarih: ${e.transferDate} ${e.transferTime}\nğŸš— AraÃ§: ${e.vehicleType}\nğŸ‘¥ Yolcu: ${e.passengerCount} kiÅŸi\nğŸ’° Ãœcret: â‚¬${e.totalAmount}\n\nğŸ›£ï¸ GÃœZERGAH:\nğŸŸ¢ ${e.pickupLocation}\nğŸ”´ ${e.dropoffLocation}\n\n${e.flightNumber?`âœˆï¸ UÃ§uÅŸ: ${e.flightNumber}`:""}\n\nÅofÃ¶r bilgileri transfer gÃ¼nÃ¼ paylaÅŸÄ±lacaktÄ±r.\n\nğŸ“ Destek: 0850 XXX XX XX`}createPaymentMessage(e){return`ğŸ’³ ${this.settings?.senderName||"SBS Transfer"}\n\nâœ… Ã–demeniz alÄ±ndÄ±!\n\nğŸ“‹ Rezervasyon: ${e.reservationNumber}\nğŸ’° Tutar: â‚¬${e.totalAmount}\nğŸ’³ YÃ¶ntem: ${e.paymentMethod}\nğŸ“… Tarih: ${(new Date).toLocaleDateString("tr-TR")}\n\nTransfer detaylarÄ±nÄ±z e-posta adresinize gÃ¶nderildi.\n\nğŸ“ Destek: 0850 XXX XX XX`}createDriverInfoMessage(e,s){return`ğŸš— ${this.settings?.senderName||"SBS Transfer"}\n\nğŸ‘¨â€âœˆï¸ ÅOFÃ–R BÄ°LGÄ°LERÄ°\n\nğŸ“‹ Rezervasyon: ${e.reservationNumber}\nğŸ“… Tarih: ${e.transferDate} ${e.transferTime}\n\nğŸ§‘â€ğŸ¤â€ğŸ§‘ ÅofÃ¶r: ${s.name}\nğŸ“± Telefon: ${s.phone}\nğŸš— AraÃ§: ${s.vehicleModel}\nğŸ”¢ Plaka: ${s.plateNumber}\n\nğŸ›£ï¸ GÃœZERGAH:\nğŸŸ¢ ${e.pickupLocation}\nğŸ”´ ${e.dropoffLocation}\n\nÄ°yi yolculuklar!\n\nğŸ“ Destek: 0850 XXX XX XX`}async sendTestSMS(e){if(!this.isServer)return{success:!1,message:"Test SMS browser'da desteklenmiyor"};this.settings||await this.loadSettings();const s=`ğŸ“± Test SMS - ${this.settings?.senderName||"SBS Transfer"}\n\nBu bir test mesajÄ±dÄ±r. SMS ayarlarÄ±nÄ±z baÅŸarÄ±yla yapÄ±landÄ±rÄ±lmÄ±ÅŸtÄ±r.\n\nTarih: ${(new Date).toLocaleString("tr-TR")}`;return await this.sendSMS(e,s)}};export{i as default,i as smsService};
