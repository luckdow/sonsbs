const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/chunk-BJ_koBnH.js","js/chunk-Bkkzv6j4.js"])))=>i.map(i=>d[i]);
import{_ as e}from"./chunk-uNZoKFSG.js";import{d as s}from"./index-B4sOzZkQ.js";import{m as t,n}from"./chunk-SPeBi8oJ.js";import"./chunk-BXGe81IW.js";import"./chunk-rj-8a6OE.js";import"./chunk-Bkkzv6j4.js";import"./chunk-Do_hQOja.js";const i=new class{constructor(){this.isServer="undefined"==typeof window,this.twilio=null,this.settings=null}async loadSettings(){if(this.isServer)try{const r=await t(n(s,"settings","general"));if(r.exists()){const s=r.data();if(this.settings={enableSMS:s.enableSMS||!1,twilioAccountSid:s.twilioAccountSid||"",twilioAuthToken:s.twilioAuthToken||"",twilioPhoneNumber:s.twilioPhoneNumber||"",senderName:s.senderName||"SBS Transfer"},this.settings.twilioAccountSid&&this.settings.twilioAuthToken)try{const s=(await e(async()=>{const{default:e}=await import("./chunk-BJ_koBnH.js").then(e=>e.i);return{default:e}},__vite__mapDeps([0,1]))).default;this.twilio=new s(this.settings.twilioAccountSid,this.settings.twilioAuthToken)}catch(i){}}}catch(i){}}async sendReservationConfirmation(e){if(!this.isServer)return{success:!1,message:"SMS gönderimi sadece server-side desteklenir"};if(this.settings||await this.loadSettings(),!this.settings?.enableSMS)return{success:!1,message:"SMS gönderimi kapalı"};const s=this.createReservationMessage(e);return await this.sendSMS(e.customerPhone,s)}async sendPaymentConfirmation(e){if(!this.isServer)return{success:!1,message:"SMS gönderimi sadece server-side desteklenir"};if(this.settings||await this.loadSettings(),!this.settings?.enableSMS)return{success:!1,message:"SMS gönderimi kapalı"};const s=this.createPaymentMessage(e);return await this.sendSMS(e.customerPhone,s)}async sendDriverInfo(e,s){if(!this.isServer)return{success:!1,message:"SMS gönderimi sadece server-side desteklenir"};if(this.settings||await this.loadSettings(),!this.settings?.enableSMS)return{success:!1,message:"SMS gönderimi kapalı"};const t=this.createDriverInfoMessage(e,s);return await this.sendSMS(e.customerPhone,t)}async sendSMS(e,s){if(!this.isServer)return{success:!1,message:"SMS gönderimi browser'da desteklenmiyor"};try{if(!this.twilio)throw new Error("Twilio ayarları eksik");if(!this.settings?.twilioPhoneNumber)throw new Error("Twilio telefon numarası ayarlanmamış");const t=this.formatPhoneNumber(e);return{success:!0,messageId:(await this.twilio.messages.create({body:s,from:this.settings.twilioPhoneNumber,to:t})).sid,message:"SMS başarıyla gönderildi"}}catch(t){return{success:!1,error:t.message,message:"SMS gönderilemedi"}}}formatPhoneNumber(e){if(!e)return"";let s=e.replace(/\D/g,"");return s.startsWith("0")?s="90"+s.substring(1):s.startsWith("90")||(s="90"+s),"+"+s}createReservationMessage(e){return`🎉 ${this.settings?.senderName||"SBS Transfer"}\n\n✅ Rezervasyonunuz onaylandı!\n\n📋 No: ${e.reservationNumber}\n📅 Tarih: ${e.transferDate} ${e.transferTime}\n🚗 Araç: ${e.vehicleType}\n👥 Yolcu: ${e.passengerCount} kişi\n💰 Ücret: €${e.totalAmount}\n\n🛣️ GÜZERGAH:\n🟢 ${e.pickupLocation}\n🔴 ${e.dropoffLocation}\n\n${e.flightNumber?`✈️ Uçuş: ${e.flightNumber}`:""}\n\nŞoför bilgileri transfer günü paylaşılacaktır.\n\n📞 Destek: 0850 XXX XX XX`}createPaymentMessage(e){return`💳 ${this.settings?.senderName||"SBS Transfer"}\n\n✅ Ödemeniz alındı!\n\n📋 Rezervasyon: ${e.reservationNumber}\n💰 Tutar: €${e.totalAmount}\n💳 Yöntem: ${e.paymentMethod}\n📅 Tarih: ${(new Date).toLocaleDateString("tr-TR")}\n\nTransfer detaylarınız e-posta adresinize gönderildi.\n\n📞 Destek: 0850 XXX XX XX`}createDriverInfoMessage(e,s){return`🚗 ${this.settings?.senderName||"SBS Transfer"}\n\n👨‍✈️ ŞOFÖR BİLGİLERİ\n\n📋 Rezervasyon: ${e.reservationNumber}\n📅 Tarih: ${e.transferDate} ${e.transferTime}\n\n🧑‍🤝‍🧑 Şoför: ${s.name}\n📱 Telefon: ${s.phone}\n🚗 Araç: ${s.vehicleModel}\n🔢 Plaka: ${s.plateNumber}\n\n🛣️ GÜZERGAH:\n🟢 ${e.pickupLocation}\n🔴 ${e.dropoffLocation}\n\nİyi yolculuklar!\n\n📞 Destek: 0850 XXX XX XX`}async sendTestSMS(e){if(!this.isServer)return{success:!1,message:"Test SMS browser'da desteklenmiyor"};this.settings||await this.loadSettings();const s=`📱 Test SMS - ${this.settings?.senderName||"SBS Transfer"}\n\nBu bir test mesajıdır. SMS ayarlarınız başarıyla yapılandırılmıştır.\n\nTarih: ${(new Date).toLocaleString("tr-TR")}`;return await this.sendSMS(e,s)}};export{i as default,i as smsService};
