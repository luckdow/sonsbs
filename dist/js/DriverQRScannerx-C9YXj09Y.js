import{j as e,a as s,au as a,U as t,d as r,u as l,ah as n,r as i}from"./chunk-Do_hQOja.js";import{r as d}from"./chunk-rj-8a6OE.js";import{n as c,m as o,u as m,Q as u}from"./chunk-SPeBi8oJ.js";import{V as x,d as h}from"./index-B4sOzZkQ.js";import{Q as g}from"./chunk-zIOiuQdg.js";import{u as p,a as y}from"./chunk-Dorn0VCo.js";import"./chunk-Bkkzv6j4.js";import"./chunk-uNZoKFSG.js";import"./chunk-BXGe81IW.js";const b=()=>{const[b,j]=d.useState(!1),[f,N]=d.useState(null),[v,k]=d.useState("waiting"),[w,z]=d.useState(!1);return e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-md mx-auto px-4",children:[e.jsx("div",{className:"text-center mb-8",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(s,{className:"w-8 h-8 text-blue-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Manuel ÅžofÃ¶r Paneli"}),e.jsx("p",{className:"text-gray-600",children:"QR kod okutarak yolculuklarÄ±nÄ±zÄ± yÃ¶netin"})]})}),!f&&!b&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6 text-center",children:[e.jsx(a,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-2",children:"QR Kod Okutun"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Rezervasyon QR kodunu okutarak yolculuÄŸu baÅŸlatÄ±n"}),e.jsx("button",{onClick:()=>j(!0),className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 transition-colors",children:"QR Kod Okut"})]}),b&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-2",children:"QR Kod TarayÄ±n"}),e.jsx("p",{className:"text-gray-600",children:"Rezervasyon QR kodunu kameranÄ±za tutun"})]}),e.jsx(g,{isOpen:!0,onClose:()=>j(!1),onScan:async e=>{try{let a;z(!0);try{a=JSON.parse(e)}catch(s){return void x.error("GeÃ§ersiz QR kod formatÄ±")}const t=a.reservationId;if(!t)return void x.error("QR kodunda rezervasyon ID bulunamadÄ±");const r=c(h,"reservations",t),l=await o(r);if(!l.exists())return void x.error("Rezervasyon bulunamadÄ±");const n={id:l.id,...l.data()};if("completed"===n.status)return void x.error("Bu rezervasyon zaten tamamlanmÄ±ÅŸ");if("confirmed"!==n.status&&"in_progress"!==n.status)return void x.error("Bu rezervasyon henÃ¼z onaylanmamÄ±ÅŸ");if("manual"!==n.assignedDriver||!n.manualDriverInfo)return void x.error("Bu rezervasyon manuel ÅŸofÃ¶re atanmamÄ±ÅŸ");N(n),"in_progress"===n.status?(k("started"),x.success("Devam eden yolculuk yÃ¼klendi")):x.success("Rezervasyon baÅŸarÄ±yla yÃ¼klendi"),j(!1)}catch(s){x.error("QR kod okunurken hata oluÅŸtu")}finally{z(!1)}}}),e.jsx("button",{onClick:()=>j(!1),className:"w-full mt-4 bg-gray-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-gray-700 transition-colors",children:"Ä°ptal"})]}),f&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Rezervasyon DetaylarÄ±"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(t,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-800",children:[f.customerInfo?.firstName," ",f.customerInfo?.lastName]}),e.jsx("p",{className:"text-sm text-gray-600",children:f.customerInfo?.phone})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(r,{className:"w-5 h-5 text-gray-400 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:"GÃ¼zergah"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Nereden:"})," ",f.tripDetails?.pickupLocation]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Nereye:"})," ",f.tripDetails?.dropoffLocation]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(l,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:"Tarih & Saat"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[f.tripDetails?.date," - ",f.tripDetails?.time]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(n,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:"Ãœcret Bilgisi"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Toplam: â‚¬",f.totalPrice]}),e.jsxs("p",{className:"text-sm text-green-600 font-medium",children:["Sizin Hak EdiÅŸiniz: â‚¬",f.manualDriverInfo?.price]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsxs("div",{className:"text-center",children:["waiting"===v&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(l,{className:"w-8 h-8 text-blue-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Yolculuk BaÅŸlatmaya HazÄ±r"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"MÃ¼ÅŸteri hazÄ±r olduÄŸunda yolculuÄŸu baÅŸlatÄ±n"}),e.jsx("button",{onClick:async()=>{if(f)try{z(!0);const e=c(h,"reservations",f.id);await m(e,{status:"in_progress",startedAt:u(),updatedAt:u()}),k("started"),x.success("ðŸš— Yolculuk baÅŸlatÄ±ldÄ±!")}catch(e){x.error("Yolculuk baÅŸlatÄ±lÄ±rken hata oluÅŸtu")}finally{z(!1)}},disabled:w,className:"w-full bg-green-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-green-700 transition-colors disabled:opacity-50",children:w?"BaÅŸlatÄ±lÄ±yor...":"YolculuÄŸu BaÅŸlat"})]}),"started"===v&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(s,{className:"w-8 h-8 text-orange-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Yolculuk Devam Ediyor"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Hedefe vardÄ±ÄŸÄ±nÄ±zda yolculuÄŸu tamamlayÄ±n"}),e.jsx("button",{onClick:async()=>{if(f)try{z(!0);const e=c(h,"reservations",f.id);await m(e,{status:"completed",completedAt:u(),updatedAt:u()}),"manual"===f.assignedDriver||f.manualDriverInfo?await p(f.id,{...f,status:"completed",completedAt:u()}):(f.assignedDriver||f.assignedDriverId)&&await y(f.id,{...f,status:"completed",completedAt:u()}),k("completed"),x.success("ðŸŽ‰ Yolculuk tamamlandÄ±! Finansal kayÄ±tlar gÃ¼ncellendi."),setTimeout(()=>{N(null),k("waiting")},3e3)}catch(e){x.error("Yolculuk tamamlanÄ±rken hata oluÅŸtu")}finally{z(!1)}},disabled:w,className:"w-full bg-purple-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-purple-700 transition-colors disabled:opacity-50",children:w?"TamamlanÄ±yor...":"YolculuÄŸu Tamamla"})]}),"completed"===v&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(i,{className:"w-8 h-8 text-green-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Yolculuk TamamlandÄ±!"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Finansal kayÄ±tlar gÃ¼ncellendi. Yeni QR kod okutabilirsiniz."})]})]}),"completed"!==v&&e.jsx("button",{onClick:()=>{N(null),k("waiting"),j(!1)},className:"w-full mt-4 bg-gray-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-gray-700 transition-colors",children:"Yeni QR Kod Okut"})]})]}),w&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Ä°ÅŸlem yapÄ±lÄ±yor..."})]})})]})})};export{b as default};
