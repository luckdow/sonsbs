const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/chunk-BJ_koBnH.js","js/chunk-Bkkzv6j4.js"])))=>i.map(i=>d[i]);
import{_ as e}from"./chunk-CY8KpSnY.js";import{d as t}from"./index-B7_6YKqI.js";import{m as n,n as s}from"./chunk-BY_DoteD.js";import"./chunk-D-dPr7Hw.js";import"./chunk-rj-8a6OE.js";import"./chunk-Bkkzv6j4.js";import"./chunk-BcaSFcXu.js";const i=new class{constructor(){this.twilio=null,this.settings=null}async loadSettings(){try{const i=await n(s(t,"settings","general"));if(i.exists()){const t=i.data();if(this.settings={enableSMS:t.enableSMS||!1,twilioAccountSid:t.twilioAccountSid||"",twilioAuthToken:t.twilioAuthToken||"",twilioPhoneNumber:t.twilioPhoneNumber||"",senderName:t.senderName||"SBS Transfer"},this.settings.twilioAccountSid&&this.settings.twilioAuthToken){const t=(await e(async()=>{const{default:e}=await import("./chunk-BJ_koBnH.js").then(e=>e.i);return{default:e}},__vite__mapDeps([0,1]))).default;this.twilio=new t(this.settings.twilioAccountSid,this.settings.twilioAuthToken)}}}catch(i){}}async sendReservationConfirmation(e){if(this.settings||await this.loadSettings(),!this.settings?.enableSMS)return{success:!1,message:"SMS gönderimi kapalı"};const t=this.createReservationMessage(e);return await this.sendSMS(e.customerPhone,t)}async sendPaymentConfirmation(e){if(this.settings||await this.loadSettings(),!this.settings?.enableSMS)return{success:!1,message:"SMS gönderimi kapalı"};const t=this.createPaymentMessage(e);return await this.sendSMS(e.customerPhone,t)}async sendDriverInfo(e,t){if(this.settings||await this.loadSettings(),!this.settings?.enableSMS)return{success:!1,message:"SMS gönderimi kapalı"};const n=this.createDriverInfoMessage(e,t);return await this.sendSMS(e.customerPhone,n)}async sendSMS(e,t){try{if(!this.twilio)throw new Error("Twilio ayarları eksik");if(!this.settings?.twilioPhoneNumber)throw new Error("Twilio telefon numarası ayarlanmamış");const n=this.formatPhoneNumber(e);return{success:!0,messageId:(await this.twilio.messages.create({body:t,from:this.settings.twilioPhoneNumber,to:n})).sid,message:"SMS başarıyla gönderildi"}}catch(n){return{success:!1,error:n.message,message:"SMS gönderilemedi"}}}formatPhoneNumber(e){if(!e)return"";let t=e.replace(/\D/g,"");return t.startsWith("0")?t="90"+t.substring(1):t.startsWith("90")||(t="90"+t),"+"+t}createReservationMessage(e){return`🎉 ${this.settings?.senderName||"SBS Transfer"}\n\n✅ Rezervasyonunuz onaylandı!\n\n📋 No: ${e.reservationNumber}\n📅 Tarih: ${e.transferDate} ${e.transferTime}\n🚗 Araç: ${e.vehicleType}\n👥 Yolcu: ${e.passengerCount} kişi\n💰 Ücret: €${e.totalAmount}\n\n🛣️ GÜZERGAH:\n🟢 ${e.pickupLocation}\n🔴 ${e.dropoffLocation}\n\n${e.flightNumber?`✈️ Uçuş: ${e.flightNumber}`:""}\n\nŞoför bilgileri transfer günü paylaşılacaktır.\n\n📞 Destek: 0850 XXX XX XX`}createPaymentMessage(e){return`💳 ${this.settings?.senderName||"SBS Transfer"}\n\n✅ Ödemeniz alındı!\n\n📋 Rezervasyon: ${e.reservationNumber}\n💰 Tutar: €${e.totalAmount}\n💳 Yöntem: ${e.paymentMethod}\n📅 Tarih: ${(new Date).toLocaleDateString("tr-TR")}\n\nTransfer detaylarınız e-posta adresinize gönderildi.\n\n📞 Destek: 0850 XXX XX XX`}createDriverInfoMessage(e,t){return`🚗 ${this.settings?.senderName||"SBS Transfer"}\n\n👨‍✈️ ŞOFÖR BİLGİLERİ\n\n📋 Rezervasyon: ${e.reservationNumber}\n📅 Tarih: ${e.transferDate} ${e.transferTime}\n\n🧑‍🤝‍🧑 Şoför: ${t.name}\n📱 Telefon: ${t.phone}\n🚗 Araç: ${t.vehicleModel}\n🔢 Plaka: ${t.plateNumber}\n\n🛣️ GÜZERGAH:\n🟢 ${e.pickupLocation}\n🔴 ${e.dropoffLocation}\n\nİyi yolculuklar!\n\n📞 Destek: 0850 XXX XX XX`}async sendTestSMS(e){this.settings||await this.loadSettings();const t=`📱 Test SMS - ${this.settings?.senderName||"SBS Transfer"}\n\nBu bir test mesajıdır. SMS ayarlarınız başarıyla yapılandırılmıştır.\n\nTarih: ${(new Date).toLocaleString("tr-TR")}`;return await this.sendSMS(e,t)}};export{i as default,i as smsService};
