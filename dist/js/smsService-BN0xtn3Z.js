const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/chunk-BJ_koBnH.js","js/chunk-Bkkzv6j4.js"])))=>i.map(i=>d[i]);
import{_ as e}from"./chunk-CY8KpSnY.js";import{d as t}from"./index-B7_6YKqI.js";import{m as n,n as s}from"./chunk-BY_DoteD.js";import"./chunk-D-dPr7Hw.js";import"./chunk-rj-8a6OE.js";import"./chunk-Bkkzv6j4.js";import"./chunk-BcaSFcXu.js";const i=new class{constructor(){this.twilio=null,this.settings=null}async loadSettings(){try{const i=await n(s(t,"settings","general"));if(i.exists()){const t=i.data();if(this.settings={enableSMS:t.enableSMS||!1,twilioAccountSid:t.twilioAccountSid||"",twilioAuthToken:t.twilioAuthToken||"",twilioPhoneNumber:t.twilioPhoneNumber||"",senderName:t.senderName||"SBS Transfer"},this.settings.twilioAccountSid&&this.settings.twilioAuthToken){const t=(await e(async()=>{const{default:e}=await import("./chunk-BJ_koBnH.js").then(e=>e.i);return{default:e}},__vite__mapDeps([0,1]))).default;this.twilio=new t(this.settings.twilioAccountSid,this.settings.twilioAuthToken)}}}catch(i){}}async sendReservationConfirmation(e){if(this.settings||await this.loadSettings(),!this.settings?.enableSMS)return{success:!1,message:"SMS gÃ¶nderimi kapalÄ±"};const t=this.createReservationMessage(e);return await this.sendSMS(e.customerPhone,t)}async sendPaymentConfirmation(e){if(this.settings||await this.loadSettings(),!this.settings?.enableSMS)return{success:!1,message:"SMS gÃ¶nderimi kapalÄ±"};const t=this.createPaymentMessage(e);return await this.sendSMS(e.customerPhone,t)}async sendDriverInfo(e,t){if(this.settings||await this.loadSettings(),!this.settings?.enableSMS)return{success:!1,message:"SMS gÃ¶nderimi kapalÄ±"};const n=this.createDriverInfoMessage(e,t);return await this.sendSMS(e.customerPhone,n)}async sendSMS(e,t){try{if(!this.twilio)throw new Error("Twilio ayarlarÄ± eksik");if(!this.settings?.twilioPhoneNumber)throw new Error("Twilio telefon numarasÄ± ayarlanmamÄ±ÅŸ");const n=this.formatPhoneNumber(e);return{success:!0,messageId:(await this.twilio.messages.create({body:t,from:this.settings.twilioPhoneNumber,to:n})).sid,message:"SMS baÅŸarÄ±yla gÃ¶nderildi"}}catch(n){return{success:!1,error:n.message,message:"SMS gÃ¶nderilemedi"}}}formatPhoneNumber(e){if(!e)return"";let t=e.replace(/\D/g,"");return t.startsWith("0")?t="90"+t.substring(1):t.startsWith("90")||(t="90"+t),"+"+t}createReservationMessage(e){return`ğŸ‰ ${this.settings?.senderName||"SBS Transfer"}\n\nâœ… Rezervasyonunuz onaylandÄ±!\n\nğŸ“‹ No: ${e.reservationNumber}\nğŸ“… Tarih: ${e.transferDate} ${e.transferTime}\nğŸš— AraÃ§: ${e.vehicleType}\nğŸ‘¥ Yolcu: ${e.passengerCount} kiÅŸi\nğŸ’° Ãœcret: â‚¬${e.totalAmount}\n\nğŸ›£ï¸ GÃœZERGAH:\nğŸŸ¢ ${e.pickupLocation}\nğŸ”´ ${e.dropoffLocation}\n\n${e.flightNumber?`âœˆï¸ UÃ§uÅŸ: ${e.flightNumber}`:""}\n\nÅofÃ¶r bilgileri transfer gÃ¼nÃ¼ paylaÅŸÄ±lacaktÄ±r.\n\nğŸ“ Destek: 0850 XXX XX XX`}createPaymentMessage(e){return`ğŸ’³ ${this.settings?.senderName||"SBS Transfer"}\n\nâœ… Ã–demeniz alÄ±ndÄ±!\n\nğŸ“‹ Rezervasyon: ${e.reservationNumber}\nğŸ’° Tutar: â‚¬${e.totalAmount}\nğŸ’³ YÃ¶ntem: ${e.paymentMethod}\nğŸ“… Tarih: ${(new Date).toLocaleDateString("tr-TR")}\n\nTransfer detaylarÄ±nÄ±z e-posta adresinize gÃ¶nderildi.\n\nğŸ“ Destek: 0850 XXX XX XX`}createDriverInfoMessage(e,t){return`ğŸš— ${this.settings?.senderName||"SBS Transfer"}\n\nğŸ‘¨â€âœˆï¸ ÅOFÃ–R BÄ°LGÄ°LERÄ°\n\nğŸ“‹ Rezervasyon: ${e.reservationNumber}\nğŸ“… Tarih: ${e.transferDate} ${e.transferTime}\n\nğŸ§‘â€ğŸ¤â€ğŸ§‘ ÅofÃ¶r: ${t.name}\nğŸ“± Telefon: ${t.phone}\nğŸš— AraÃ§: ${t.vehicleModel}\nğŸ”¢ Plaka: ${t.plateNumber}\n\nğŸ›£ï¸ GÃœZERGAH:\nğŸŸ¢ ${e.pickupLocation}\nğŸ”´ ${e.dropoffLocation}\n\nÄ°yi yolculuklar!\n\nğŸ“ Destek: 0850 XXX XX XX`}async sendTestSMS(e){this.settings||await this.loadSettings();const t=`ğŸ“± Test SMS - ${this.settings?.senderName||"SBS Transfer"}\n\nBu bir test mesajÄ±dÄ±r. SMS ayarlarÄ±nÄ±z baÅŸarÄ±yla yapÄ±landÄ±rÄ±lmÄ±ÅŸtÄ±r.\n\nTarih: ${(new Date).toLocaleString("tr-TR")}`;return await this.sendSMS(e,t)}};export{i as default,i as smsService};
