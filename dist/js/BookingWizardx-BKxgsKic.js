import{j as e,x as s,p as a,d as t,C as r,v as l,m as i,y as n,z as o,E as c,c as d,s as m,a as x,e as u,t as g,P as p,U as h,q as f,M as b,r as y,J as j,K as N,N as v,S as w,O as k,Q as C,V as S,D as T,W as z,Y as D,Z as L}from"./chunk-BcaSFcXu.js";import{r as R,a as B}from"./chunk-rj-8a6OE.js";import{B as I,H as A,n as M,K}from"./chunk-BY_DoteD.js";import{d as G}from"./index-B7_6YKqI.js";import{g as _,c as E}from"./chunk-Bqp865i9.js";import{smsService as H}from"./smsService-BN0xtn3Z.js";import"./chunk-Bkkzv6j4.js";import"./chunk-CY8KpSnY.js";import"./chunk-D-dPr7Hw.js";const $=({bookingData:p,updateBookingData:h,onNext:f})=>{const[b,y]=R.useState(p.tripType||"one-way"),[j,N]=R.useState(p.pickupLocation||""),[v,w]=R.useState(p.dropoffLocation||""),[k,C]=R.useState(p.date||(new Date).toISOString().slice(0,10)),[S,T]=R.useState(p.time||(()=>{const e=new Date;return e.setHours(e.getHours()+4),e.toTimeString().slice(0,5)})()),[z,D]=R.useState(p.returnDate||""),[L,B]=R.useState(p.returnTime||""),[M,K]=R.useState(p.passengerCount||1),[H,$]=R.useState(p.baggageCount||0),[P,V]=R.useState(p.routeInfo||null),[F,O]=R.useState(!1),[U,Y]=R.useState(!1),[q,J]=R.useState(p.selectedVehicle||null),[Z,W]=R.useState([]),[Q,X]=R.useState(!1),[ee,se]=R.useState(!1),[ae,te]=R.useState([]),[re,le]=R.useState([]),[ie,ne]=R.useState(!1),[oe,ce]=R.useState(!1),[de,me]=R.useState([]),[xe,ue]=R.useState([]),ge=R.useRef(null),pe=R.useRef(null);R.useRef(null),R.useRef(null);const he=R.useRef(null),fe=R.useRef(null),be=R.useRef(null),ye=R.useRef(null);R.useEffect(()=>{p.prefilledFromHome&&(p.pickupLocation&&N(p.pickupLocation),p.dropoffLocation&&w(p.dropoffLocation),p.date&&C(p.date),p.time&&T(p.time),p.passengerCount&&K(p.passengerCount),p.baggageCount&&$(p.baggageCount),p.showVehicles&&p.pickupLocation&&p.dropoffLocation&&(se(!0),we(),setTimeout(()=>{ke(p.pickupLocation,p.dropoffLocation)},1e3)))},[p.prefilledFromHome]),R.useEffect(()=>{(()=>{if(!(window.google&&window.google.maps&&window.google.maps.places)){const e=setInterval(()=>{window.google&&window.google.maps&&window.google.maps.places&&(je(),clearInterval(e))},500);return setTimeout(()=>{clearInterval(e)},1e4),()=>clearInterval(e)}setTimeout(()=>{je()},100)})()},[]);const je=()=>{try{if(!window.google||!window.google.maps||!window.google.maps.places)return;he.current=new window.google.maps.places.PlacesService(document.createElement("div")),be.current=new window.google.maps.DirectionsService,ye.current=new window.google.maps.DirectionsRenderer({suppressMarkers:!1,draggable:!1})}catch(e){}},Ne=(e,s=!0)=>{if(!he.current||!e||e.length<2)return void(s?me([]):ue([]));const a={query:e,bounds:new window.google.maps.LatLngBounds(new window.google.maps.LatLng(36,29),new window.google.maps.LatLng(37.5,32.5)),fields:["place_id","formatted_address","geometry","name","rating","types"]};he.current.textSearch(a,(e,a)=>{if(a===window.google.maps.places.PlacesServiceStatus.OK&&e){const a=e.slice(0,5).map(e=>({name:e.name,address:e.formatted_address,lat:e.geometry.location.lat(),lng:e.geometry.location.lng(),rating:e.rating||0,type:"google",place_id:e.place_id,types:e.types||[]}));s?me(a):ue(a)}else s?me([]):ue([])})},ve=()=>Z.filter(e=>e.capacity>=M).sort((e,s)=>e.capacity-s.capacity);R.useEffect(()=>{we()},[]),R.useEffect(()=>{p.prefilledFromHome&&p.showVehicles&&(p.pickupLocation&&"object"==typeof p.pickupLocation&&N(p.pickupLocation.address||p.pickupLocation.name||""),p.dropoffLocation&&"object"==typeof p.dropoffLocation&&w(p.dropoffLocation.address||p.dropoffLocation.name||""),se(!0))},[p.prefilledFromHome,p.showVehicles,p.pickupLocation,p.dropoffLocation]);const we=async()=>{X(!0);try{const e=I(G,"vehicles"),s=await A(e);if(s.empty)return void W([]);const a=s.docs.map(e=>{const s=e.data();return{id:e.id,name:s.name||`${s.brand} ${s.model}`||"Bilinmeyen Araç",description:s.description||`${s.year} model ${s.brand} ${s.model}`,capacity:s.capacity||4,luggage:s.baggage||2,basePrice:s.kmRate||25,pricePerKm:s.pricePerKm||(s.kmRate?s.kmRate/10:2),status:s.isActive?"active":"inactive",image:s.imageUrl||s.image||"",features:s.features||[],type:s.type||"sedan",pricing:s.pricing||_(s.type||"sedan"),kmRate:s.kmRate||25,rating:s.rating||4,brand:s.brand||"",model:s.model||"",color:s.color||"",year:s.year||(new Date).getFullYear(),...s}}).filter(e=>"active"===e.status);W(a)}catch(e){W([])}finally{X(!1)}},ke=async(e,s)=>{if(e&&s&&e.lat&&s.lat){O(!0);try{if(window.google&&window.google.maps&&be.current){const a={origin:new window.google.maps.LatLng(e.lat,e.lng),destination:new window.google.maps.LatLng(s.lat,s.lng),travelMode:window.google.maps.TravelMode.DRIVING,unitSystem:window.google.maps.UnitSystem.METRIC};be.current.route(a,(e,s)=>{if("OK"===s){const s=e.routes[0].legs[0],a={distance:s.distance.text,duration:s.duration.text,distanceValue:s.distance.value,durationValue:s.duration.value};V(a),Y(!0),setTimeout(()=>{Ce(e)},100)}O(!1)})}}catch(a){O(!1)}}},Ce=e=>{if(!fe.current||!window.google)return;const s=new window.google.maps.Map(fe.current,{zoom:11,center:{lat:36.8969,lng:30.7133},mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1,zoomControl:!0,zoomControlOptions:{position:window.google.maps.ControlPosition.RIGHT_BOTTOM},styles:[{featureType:"all",elementType:"geometry.fill",stylers:[{weight:"2.00"}]},{featureType:"all",elementType:"geometry.stroke",stylers:[{color:"#9c9c9c"}]},{featureType:"all",elementType:"labels.text",stylers:[{visibility:"on"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"water",elementType:"all",stylers:[{color:"#46bcec"},{visibility:"on"}]}]});ye.current&&e&&(ye.current.setDirections(e),ye.current.setMap(s),ye.current.setOptions({polylineOptions:{strokeColor:"#3B82F6",strokeWeight:4,strokeOpacity:.8}}))},Se=(e,s=!0)=>{const a={address:e.address||e.name,lat:e.lat,lng:e.lng,rating:e.rating};s?(N(a),ne(!1),ge.current&&(ge.current.value=e.address||e.name)):(w(a),ce(!1),pe.current&&(pe.current.value=e.address||e.name));const t=s?a:j,r=s?v:a;t&&r&&t.lat&&r.lat&&ke(t,r)},Te=e=>{if(!P||!P.distanceValue)return 25;const s=P.distanceValue/1e3;return E(s,e,"round-trip"===b).totalPrice},ze=e=>{K(s=>{const a=e?s<50?s+1:s:s>1?s-1:s;return q&&q.capacity<a&&J(null),a>0&&se(!0),a})},De=e=>{$(s=>e?s<20?s+1:s:s>0?s-1:s)},Le=()=>(new Date).toISOString().slice(0,10);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Rota ve Araç Seçimi"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Transfer rotanızı belirleyin ve aracınızı seçin"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Yolculuk Türü"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>y("one-way"),className:`\n              relative p-2 sm:p-4 rounded-lg border-2 transition-all duration-200\n              ${"one-way"===b?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white text-gray-700 hover:border-gray-300"}\n            `,children:[e.jsxs("div",{className:"flex items-center justify-center space-x-1 sm:space-x-2",children:[e.jsx(s,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:"Tek Yön"})]}),"one-way"===b&&e.jsx(a,{className:"absolute top-1 right-1 sm:top-2 sm:right-2 w-4 h-4 sm:w-5 sm:h-5 text-blue-500"})]}),e.jsxs("button",{type:"button",onClick:()=>y("round-trip"),className:`\n              relative p-2 sm:p-4 rounded-lg border-2 transition-all duration-200\n              ${"round-trip"===b?"border-purple-500 bg-purple-50 text-purple-700":"border-gray-200 bg-white text-gray-700 hover:border-gray-300"}\n            `,children:[e.jsxs("div",{className:"flex items-center justify-center space-x-1 sm:space-x-2",children:[e.jsx(s,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:"Gidiş-Dönüş"})]}),"round-trip"===b&&e.jsx(a,{className:"absolute top-1 right-1 sm:top-2 sm:right-2 w-4 h-4 sm:w-5 sm:h-5 text-purple-500"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 relative",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nereden"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 z-10",children:e.jsx("div",{className:"w-6 h-6 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(t,{className:"w-3 h-3 text-green-600"})})}),e.jsx("input",{ref:ge,type:"text",placeholder:"Başlangıç noktanızı girin...",className:"w-full pl-12 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm",value:"string"==typeof j?j:j?.address||"",onChange:e=>{const s=e.target.value;N(s),ne(s.length>0),Ne(s,!0)},onFocus:()=>ne(!0),onBlur:()=>setTimeout(()=>ne(!1),200)}),e.jsx(r,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"})]}),ie&&de.length>0&&e.jsxs("div",{className:"absolute top-full left-0 right-0 z-50 bg-white border border-gray-200 rounded-lg shadow-lg mt-1 max-h-48 overflow-hidden",children:[e.jsx("div",{className:"px-3 py-2 border-b border-gray-100 bg-blue-50",children:e.jsxs("p",{className:"text-xs font-medium text-blue-700 flex items-center",children:[e.jsx("span",{className:"w-3 h-3 bg-blue-500 rounded text-white text-[8px] flex items-center justify-center mr-2",children:"G"}),"Google Önerileri"]})}),e.jsx("div",{className:"max-h-40 overflow-y-auto",children:de.slice(0,4).map((s,a)=>e.jsx("button",{type:"button",onClick:()=>Se(s,!0),className:"w-full px-3 py-2 hover:bg-blue-50 focus:bg-blue-50 flex items-center text-left border-b border-gray-50 last:border-b-0 transition-colors",children:e.jsxs("div",{className:"flex items-center space-x-2 w-full min-w-0",children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0",children:e.jsx(t,{className:"w-3 h-3 text-blue-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-900 truncate text-sm",children:s.name}),e.jsx("div",{className:"text-xs text-gray-500 truncate",children:s.address})]}),s.rating>0&&e.jsxs("div",{className:"flex items-center space-x-1 flex-shrink-0",children:[e.jsx(l,{className:"w-3 h-3 text-yellow-400 fill-current"}),e.jsx("span",{className:"text-xs text-gray-600",children:s.rating})]})]})},`google-${a}`))})]})]}),e.jsxs("div",{className:"space-y-2 relative",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nereye"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 z-10",children:e.jsx("div",{className:"w-6 h-6 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(t,{className:"w-3 h-3 text-red-600"})})}),e.jsx("input",{ref:pe,type:"text",placeholder:"Varış noktanızı girin...",className:"w-full pl-12 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 text-sm",value:"string"==typeof v?v:v?.address||"",onChange:e=>{const s=e.target.value;w(s),ce(s.length>0),Ne(s,!1)},onFocus:()=>ce(!0),onBlur:()=>setTimeout(()=>ce(!1),200)}),e.jsx(r,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"})]}),oe&&xe.length>0&&e.jsxs("div",{className:"absolute top-full left-0 right-0 z-50 bg-white border border-gray-200 rounded-lg shadow-lg mt-1 max-h-48 overflow-hidden",children:[e.jsx("div",{className:"px-3 py-2 border-b border-gray-100 bg-blue-50",children:e.jsxs("p",{className:"text-xs font-medium text-blue-700 flex items-center",children:[e.jsx("span",{className:"w-3 h-3 bg-blue-500 rounded text-white text-[8px] flex items-center justify-center mr-2",children:"G"}),"Google Önerileri"]})}),e.jsx("div",{className:"max-h-40 overflow-y-auto",children:xe.slice(0,4).map((s,a)=>e.jsx("button",{type:"button",onClick:()=>Se(s,!1),className:"w-full px-3 py-2 hover:bg-blue-50 focus:bg-blue-50 flex items-center text-left border-b border-gray-50 last:border-b-0 transition-colors",children:e.jsxs("div",{className:"flex items-center space-x-2 w-full min-w-0",children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0",children:e.jsx(t,{className:"w-3 h-3 text-blue-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-900 truncate text-sm",children:s.name}),e.jsx("div",{className:"text-xs text-gray-500 truncate",children:s.address})]}),s.rating>0&&e.jsxs("div",{className:"flex items-center space-x-1 flex-shrink-0",children:[e.jsx(l,{className:"w-3 h-3 text-yellow-400 fill-current"}),e.jsx("span",{className:"text-xs text-gray-600",children:s.rating})]})]})},`google-${a}`))})]})]})]}),P&&e.jsxs(i.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"text-lg font-medium text-gray-900 flex items-center",children:[e.jsx(n,{className:"w-4 h-4 mr-2 text-blue-600"}),"Rota Bilgileri"]}),F&&e.jsx("div",{className:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"})]}),e.jsx("div",{className:"w-full",children:e.jsx("div",{ref:fe,className:"w-full h-64 sm:h-72 md:h-80 lg:h-96 rounded-lg border border-gray-200 bg-gray-100 shadow-md",style:{minHeight:"256px"}})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-left space-y-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 mr-2",children:"Mesafe:"}),e.jsx("span",{className:"text-sm font-semibold text-blue-600",children:P.distance})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 mr-2",children:"Süre:"}),e.jsx("span",{className:"text-sm font-semibold text-purple-600",children:P.duration})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Yolcu Sayısı"}),e.jsxs("div",{className:"flex items-center justify-center space-x-2 bg-blue-50 rounded-lg p-2 sm:p-3",children:[e.jsx("button",{type:"button",onClick:()=>ze(!1),className:"w-6 h-6 sm:w-8 sm:h-8 rounded-full bg-white shadow-md hover:shadow-lg flex items-center justify-center disabled:opacity-50",disabled:M<=1,children:e.jsx(o,{className:"w-3 h-3 sm:w-4 sm:h-4 text-gray-600"})}),e.jsx("div",{className:"bg-white rounded-lg px-2 py-1 sm:px-4 sm:py-2 min-w-[2rem] sm:min-w-[3rem] text-center",children:e.jsx("span",{className:"text-sm sm:text-lg font-bold text-gray-800",children:M})}),e.jsx("button",{type:"button",onClick:()=>ze(!0),className:"w-6 h-6 sm:w-8 sm:h-8 rounded-full bg-blue-500 shadow-md hover:shadow-lg hover:bg-blue-600 flex items-center justify-center disabled:opacity-50",disabled:M>=50,children:e.jsx(c,{className:"w-3 h-3 sm:w-4 sm:h-4 text-white"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Bagaj Sayısı"}),e.jsxs("div",{className:"flex items-center justify-center space-x-2 bg-purple-50 rounded-lg p-2 sm:p-3",children:[e.jsx("button",{type:"button",onClick:()=>De(!1),className:"w-6 h-6 sm:w-8 sm:h-8 rounded-full bg-white shadow-md hover:shadow-lg flex items-center justify-center disabled:opacity-50",disabled:H<=0,children:e.jsx(o,{className:"w-3 h-3 sm:w-4 sm:h-4 text-gray-600"})}),e.jsx("div",{className:"bg-white rounded-lg px-2 py-1 sm:px-4 sm:py-2 min-w-[2rem] sm:min-w-[3rem] text-center",children:e.jsx("span",{className:"text-sm sm:text-lg font-bold text-gray-800",children:H})}),e.jsx("button",{type:"button",onClick:()=>De(!0),className:"w-6 h-6 sm:w-8 sm:h-8 rounded-full bg-purple-500 shadow-md hover:shadow-lg hover:bg-purple-600 flex items-center justify-center disabled:opacity-50",disabled:H>=20,children:e.jsx(c,{className:"w-3 h-3 sm:w-4 sm:h-4 text-white"})})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Tarih ve Saat"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"round-trip"===b?"Gidiş Tarihi":"Tarih"}),e.jsxs("div",{className:"relative",children:[e.jsx(d,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"date",value:k,min:Le(),onChange:e=>C(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"round-trip"===b?"Gidiş Saati":"Saat"}),e.jsxs("div",{className:"relative",children:[e.jsx(m,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"time",value:S,onChange:e=>T(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),"round-trip"===b&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Dönüş Tarihi"}),e.jsxs("div",{className:"relative",children:[e.jsx(d,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"date",value:z,min:k||Le(),onChange:e=>D(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Dönüş Saati"}),e.jsxs("div",{className:"relative",children:[e.jsx(m,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"time",value:L,onChange:e=>B(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]})]})]})]}),ee&&P&&M>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Araç Seçimi"}),M>1&&e.jsxs("span",{className:"text-sm text-blue-600 bg-blue-50 px-2 py-1 rounded-lg",children:[M," kişi için uygun araçlar"]})]}),Q?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Araçlar yükleniyor..."})]}):0===ve().length?e.jsxs("div",{className:"text-center py-8 bg-yellow-50 rounded-lg border border-yellow-200",children:[e.jsx(x,{className:"w-8 h-8 text-yellow-600 mx-auto mb-2"}),e.jsxs("p",{className:"text-sm text-yellow-800 font-medium",children:[M," kişi için uygun araç bulunamadı"]}),e.jsx("p",{className:"text-xs text-yellow-600 mt-1",children:"Lütfen yolcu sayısını azaltın veya bizimle iletişime geçin"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:ve().map(s=>e.jsxs("button",{type:"button",onClick:()=>(e=>{J(e)})(s),className:`\n                  relative p-4 rounded-lg border-2 transition-all duration-200 text-left\n                  ${q?.id===s.id?"border-green-500 bg-green-50":"border-gray-200 bg-white hover:border-gray-300 hover:shadow-md"}\n                `,children:[e.jsxs("div",{className:"mb-3",children:[s.image||s.imageUrl?e.jsx("img",{src:s.image||s.imageUrl,alt:s.name,className:"w-full h-32 sm:h-40 object-cover rounded-lg",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}):null,e.jsx("div",{className:"w-full h-32 sm:h-40 bg-gray-100 rounded-lg flex items-center justify-center "+(s.image||s.imageUrl?"hidden":"flex"),children:e.jsx(x,{className:"w-8 h-8 text-gray-400"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-lg",children:s.name}),e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(u,{className:"w-4 h-4 mr-2"}),e.jsxs("span",{className:"text-sm font-medium",children:[s.capacity," Kişi"]})]}),s.features&&s.features.length>0&&e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.features.slice(0,4).map((s,a)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full",children:s},a)),s.features.length>4&&e.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:["+",s.features.length-4," daha"]})]})}),e.jsx("div",{className:"pt-2 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Toplam Fiyat"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-xl font-bold text-green-600",children:["€",Te(s)]}),e.jsx("div",{className:"text-xs text-gray-500",children:"round-trip"===b?"Gidiş-Dönüş":"Tek Yön"})]})]})})]}),q?.id===s.id&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx(a,{className:"w-6 h-6 text-green-500 bg-white rounded-full"})})]},s.id))})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>{const e={tripType:b,pickupLocation:j,dropoffLocation:v,date:k,time:S,returnDate:"round-trip"===b?z:null,returnTime:"round-trip"===b?L:null,passengerCount:M,baggageCount:H,selectedVehicle:q,routeInfo:P,totalPrice:q?Te(q):0};h(e),f()},className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[e.jsx("span",{children:"Kişisel Bilgilere Geç"}),e.jsx(g,{className:"w-4 h-4"})]})})]})},P=({value:s,onChange:a,placeholder:t,className:l,error:i})=>{const[n,o]=R.useState(!1),[c,d]=R.useState({code:"TR",dialCode:"+90",flag:"🇹🇷",name:"Türkiye"});return e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex w-full h-12",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>o(!n),className:"flex items-center justify-center px-3 h-12 border border-r-0 rounded-l-lg bg-gray-50 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors w-20 "+(i?"border-red-300 focus:border-red-500":"border-gray-300"),children:[e.jsx("span",{className:"text-base mr-1",children:c.flag}),e.jsx("span",{className:"text-xs font-medium text-gray-700",children:c.dialCode}),e.jsx(r,{className:"w-3 h-3 text-gray-400 ml-1"})]}),n&&e.jsx("div",{className:"absolute top-full left-0 mt-1 w-48 bg-white border border-gray-300 rounded-lg shadow-lg z-50 max-h-60 overflow-y-auto",children:[{code:"TR",dialCode:"+90",flag:"🇹🇷",name:"Türkiye"},{code:"US",dialCode:"+1",flag:"🇺🇸",name:"Amerika"},{code:"GB",dialCode:"+44",flag:"🇬🇧",name:"İngiltere"},{code:"DE",dialCode:"+49",flag:"🇩🇪",name:"Almanya"},{code:"FR",dialCode:"+33",flag:"🇫🇷",name:"Fransa"},{code:"IT",dialCode:"+39",flag:"🇮🇹",name:"İtalya"},{code:"ES",dialCode:"+34",flag:"🇪🇸",name:"İspanya"},{code:"NL",dialCode:"+31",flag:"🇳🇱",name:"Hollanda"},{code:"BE",dialCode:"+32",flag:"🇧🇪",name:"Belçika"},{code:"CH",dialCode:"+41",flag:"🇨🇭",name:"İsviçre"},{code:"AT",dialCode:"+43",flag:"🇦🇹",name:"Avusturya"},{code:"SE",dialCode:"+46",flag:"🇸🇪",name:"İsveç"},{code:"NO",dialCode:"+47",flag:"🇳🇴",name:"Norveç"},{code:"DK",dialCode:"+45",flag:"🇩🇰",name:"Danimarka"},{code:"FI",dialCode:"+358",flag:"🇫🇮",name:"Finlandiya"},{code:"RU",dialCode:"+7",flag:"🇷🇺",name:"Rusya"},{code:"UA",dialCode:"+380",flag:"🇺🇦",name:"Ukrayna"},{code:"PL",dialCode:"+48",flag:"🇵🇱",name:"Polonya"},{code:"CZ",dialCode:"+420",flag:"🇨🇿",name:"Çekya"},{code:"HU",dialCode:"+36",flag:"🇭🇺",name:"Macaristan"},{code:"GR",dialCode:"+30",flag:"🇬🇷",name:"Yunanistan"},{code:"BG",dialCode:"+359",flag:"🇧🇬",name:"Bulgaristan"},{code:"RO",dialCode:"+40",flag:"🇷🇴",name:"Romanya"},{code:"HR",dialCode:"+385",flag:"🇭🇷",name:"Hırvatistan"},{code:"RS",dialCode:"+381",flag:"🇷🇸",name:"Sırbistan"},{code:"JP",dialCode:"+81",flag:"🇯🇵",name:"Japonya"},{code:"KR",dialCode:"+82",flag:"🇰🇷",name:"Güney Kore"},{code:"CN",dialCode:"+86",flag:"🇨🇳",name:"Çin"},{code:"IN",dialCode:"+91",flag:"🇮🇳",name:"Hindistan"},{code:"AU",dialCode:"+61",flag:"🇦🇺",name:"Avustralya"},{code:"CA",dialCode:"+1",flag:"🇨🇦",name:"Kanada"},{code:"BR",dialCode:"+55",flag:"🇧🇷",name:"Brezilya"},{code:"MX",dialCode:"+52",flag:"🇲🇽",name:"Meksika"},{code:"AR",dialCode:"+54",flag:"🇦🇷",name:"Arjantin"},{code:"AE",dialCode:"+971",flag:"🇦🇪",name:"BAE"},{code:"SA",dialCode:"+966",flag:"🇸🇦",name:"Suudi Arabistan"},{code:"EG",dialCode:"+20",flag:"🇪🇬",name:"Mısır"},{code:"ZA",dialCode:"+27",flag:"🇿🇦",name:"Güney Afrika"}].map(t=>e.jsxs("button",{type:"button",onClick:()=>(e=>{d(e),o(!1);const t=s.replace(/^\+\d+\s*/,""),r=`${e.dialCode} ${t}`.trim();a(r)})(t),className:"w-full flex items-center px-3 py-2 text-left hover:bg-gray-50 transition-colors",children:[e.jsx("span",{className:"text-base mr-3",children:t.flag}),e.jsx("span",{className:"text-sm text-gray-500 font-mono",children:t.dialCode})]},t.code))}),n&&e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>o(!1)})]}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(p,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 z-10"}),e.jsx("input",{type:"tel",value:(e=>{if(!e)return"";const s=e.replace(/^\+\d+\s*/,"");if("TR"===c.code){const e=s.replace(/\D/g,"");return e.length>=10?e.slice(0,10).replace(/(\d{3})(\d{3})(\d{4})/,"$1 $2 $3"):e}return s})(s),onChange:e=>{const s=e.target.value;if(s.startsWith("+"))a(s);else{const e=`${c.dialCode} ${s}`.trim();a(e)}},placeholder:t||"555 123 4567",className:"w-full h-12 pl-10 pr-4 border border-l-0 rounded-r-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors text-sm "+(i?"border-red-300 focus:border-red-500 focus:ring-red-200":"border-gray-300")})]})]})})},V=({bookingData:s,updateBookingData:a,onNext:t,onBack:r})=>{const[l,i]=R.useState({firstName:s.personalInfo?.firstName||"",lastName:s.personalInfo?.lastName||"",email:s.personalInfo?.email||"",phone:s.personalInfo?.phone||"",flightNumber:s.personalInfo?.flightNumber||"",flightTime:s.personalInfo?.flightTime||"",specialRequests:s.personalInfo?.specialRequests||"",acceptTerms:s.personalInfo?.acceptTerms||!1}),[n,o]=R.useState({}),c=(e,s)=>{i(a=>({...a,[e]:s})),n[e]&&o(s=>({...s,[e]:""}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Kişisel Bilgiler"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"İletişim ve uçuş bilgilerinizi girin"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"İletişim Bilgileri"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Ad *"}),e.jsxs("div",{className:"relative",children:[e.jsx(h,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",value:l.firstName,onChange:e=>c("firstName",e.target.value),placeholder:"Adınızı girin",className:"w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors text-sm "+(n.firstName?"border-red-300 focus:border-red-500 focus:ring-red-200":"border-gray-300")})]}),n.firstName&&e.jsxs("div",{className:"flex items-center space-x-2 text-red-500 text-sm",children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("span",{children:n.firstName})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Soyad *"}),e.jsxs("div",{className:"relative",children:[e.jsx(h,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",value:l.lastName,onChange:e=>c("lastName",e.target.value),placeholder:"Soyadınızı girin",className:"w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors text-sm "+(n.lastName?"border-red-300 focus:border-red-500 focus:ring-red-200":"border-gray-300")})]}),n.lastName&&e.jsxs("div",{className:"flex items-center space-x-2 text-red-500 text-sm",children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("span",{children:n.lastName})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"E-posta *"}),e.jsxs("div",{className:"relative",children:[e.jsx(b,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"email",value:l.email,onChange:e=>c("email",e.target.value),placeholder:"ornek@email.com",className:"w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors text-sm "+(n.email?"border-red-300 focus:border-red-500 focus:ring-red-200":"border-gray-300")})]}),n.email&&e.jsxs("div",{className:"flex items-center space-x-2 text-red-500 text-sm",children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("span",{children:n.email})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Telefon *"}),e.jsx(P,{value:l.phone,onChange:e=>c("phone",e),placeholder:"555 123 4567",error:n.phone}),n.phone&&e.jsxs("div",{className:"flex items-center space-x-2 text-red-500 text-sm",children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("span",{children:n.phone})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Uçuş Bilgileri (Opsiyonel)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Uçuş Numarası"}),e.jsxs("div",{className:"relative",children:[e.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",value:l.flightNumber,onChange:e=>c("flightNumber",e.target.value.toUpperCase()),placeholder:"TK123",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors text-sm"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Uçuş Saati"}),e.jsxs("div",{className:"relative",children:[e.jsx(m,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"time",value:l.flightTime,onChange:e=>c("flightTime",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors text-sm"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Özel İstekler"}),e.jsxs("div",{className:"relative",children:[e.jsx(j,{className:"absolute left-3 top-3 w-4 h-4 text-gray-400"}),e.jsx("textarea",{value:l.specialRequests,onChange:e=>c("specialRequests",e.target.value),placeholder:"Bebek koltuğu, tekerlekli sandalye erişimi vb. özel isteklerinizi belirtin...",rows:4,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors resize-none text-sm"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("input",{type:"checkbox",id:"acceptTerms",checked:l.acceptTerms,onChange:e=>c("acceptTerms",e.target.checked),className:"mt-1 w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"}),e.jsxs("label",{htmlFor:"acceptTerms",className:"text-sm text-gray-700 leading-relaxed",children:[e.jsx("a",{href:"/kullanim-sartlari",target:"_blank",rel:"noopener noreferrer",className:"font-medium text-blue-600 hover:text-blue-800 underline",children:"Kullanım Şartları"})," ve"," ",e.jsx("a",{href:"/gizlilik-politikasi",target:"_blank",rel:"noopener noreferrer",className:"font-medium text-blue-600 hover:text-blue-800 underline",children:"Gizlilik Politikası"}),"'nı okudum ve kabul ediyorum. Kişisel verilerimin işlenmesine ve transfer hizmeti için kullanılmasına onay veriyorum. *"]})]}),n.acceptTerms&&e.jsxs("div",{className:"flex items-center space-x-2 text-red-500 text-sm",children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("span",{children:n.acceptTerms})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4",children:[e.jsxs("button",{type:"button",onClick:r,className:"w-full sm:w-auto px-6 py-3 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors font-medium text-sm flex items-center justify-center space-x-2",children:[e.jsx(N,{className:"w-4 h-4"}),e.jsx("span",{children:"Önceki Adım"})]}),e.jsxs("button",{type:"button",onClick:()=>{(()=>{const e={};l.firstName.trim()?l.firstName.trim().length<2&&(e.firstName="Ad en az 2 karakter olmalıdır"):e.firstName="Ad alanı zorunludur",l.lastName.trim()?l.lastName.trim().length<2&&(e.lastName="Soyad en az 2 karakter olmalıdır"):e.lastName="Soyad alanı zorunludur",l.email.trim()?/\S+@\S+\.\S+/.test(l.email)||(e.email="Geçerli bir e-posta adresi girin"):e.email="E-posta alanı zorunludur",l.phone.trim()?l.phone.replace(/\D/g,"").length<10&&(e.phone="Geçerli bir telefon numarası girin"):e.phone="Telefon alanı zorunludur";return l.flightNumber&&l.flightNumber.trim().length<3&&(e.flightNumber="Geçerli bir uçuş numarası girin"),l.acceptTerms||(e.acceptTerms="Kullanım şartlarını kabul etmelisiniz"),o(e),0===Object.keys(e).length})()&&(a({personalInfo:l}),t())},disabled:!(()=>{const e=l.phone.replace(/\D/g,"");return l.firstName.trim()&&l.lastName.trim()&&l.email.trim()&&l.phone.trim()&&l.acceptTerms&&/\S+@\S+\.\S+/.test(l.email)&&e.length>=10})(),className:"flex-1 sm:flex-none sm:min-w-[160px] px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium text-sm flex items-center justify-center space-x-2",children:[e.jsx("span",{children:"Ödeme Adımına Geç"}),e.jsx(g,{className:"w-4 h-4"})]})]})]})},F=({bookingData:s,updateBookingData:t,onComplete:l,onBack:n,isLoading:o})=>{const[c,m]=R.useState(""),[x,u]=R.useState(null),[g,p]=R.useState(!0),[b,y]=R.useState([]),[j,L]=R.useState({enabledMethods:{cash:!0,creditCard:!0,bankTransfer:!0,paytr:!1},paytrMerchantId:"",paytrMerchantKey:"",paytrMerchantSalt:"",testMode:!0}),[B,I]=R.useState({cardNumber:"",expiryDate:"",cvv:"",cardName:""}),[A,_]=R.useState({});R.useEffect(()=>{E()},[]);const E=async()=>{try{p(!0);const e=M(G,"settings","main"),s=K(e,e=>{if(e.exists()){const s=e.data();s.payment&&L(e=>({...e,...s.payment}));const a=s.bankAccounts?.filter(e=>!1!==e.isActive)||[];y(a)}p(!1)},e=>{p(!1)});return()=>s()}catch(e){p(!1)}},$=(e,s)=>{I(a=>({...a,[e]:s})),A[e]&&_(s=>({...s,[e]:""}))},P=e=>({cash:"Nakit",credit_card:"Kredi Kartı",bank_transfer:"Havale/EFT",paytr:"Online Ödeme"}[e]||e);return g?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"text-gray-600 mt-4",children:"Ödeme bilgileri yükleniyor..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Ödeme Yöntemi"}),e.jsx("p",{className:"text-gray-600 mt-1 text-xs",children:"Güvenli ödeme ile rezervasyonu tamamlayın"})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2 text-sm",children:"Rezervasyon Özeti"}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Rota:"}),e.jsxs("span",{className:"font-medium text-gray-900 text-xs",children:["object"==typeof s.pickupLocation?s.pickupLocation?.address?.split(",")[0]:s.pickupLocation?.split(",")[0]||"Belirlenmedi"," → ","object"==typeof s.dropoffLocation?s.dropoffLocation?.address?.split(",")[0]:s.dropoffLocation?.split(",")[0]||"Belirlenmedi"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Tarih:"}),e.jsxs("span",{className:"font-medium text-gray-900",children:[s.date," ",s.time]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Araç:"}),e.jsx("span",{className:"font-medium text-gray-900",children:s.selectedVehicle?.name||"Seçili Araç"})]}),e.jsx("div",{className:"border-t border-gray-200 pt-2 mt-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-semibold text-gray-900 text-sm",children:"Toplam:"}),e.jsxs("span",{className:"text-base font-bold text-blue-600",children:["€",s.totalPrice||0]})]})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Ödeme Seçenekleri"}),(j.enabledMethods.creditCard||j.enabledMethods.paytr)&&e.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[e.jsxs("button",{type:"button",onClick:()=>u("credit_card"===x?null:"credit_card"),className:"w-full p-3 flex items-center justify-between text-left hover:bg-gray-50 rounded-lg transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-4 h-4 rounded-full border-2 "+("credit_card"===c?"border-blue-500 bg-blue-500":"border-gray-300"),children:"credit_card"===c&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-white m-0.5"})}),e.jsx(v,{className:"w-4 h-4 text-gray-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Kredi Kartı"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Güvenli online ödeme"})]})]}),e.jsx(r,{className:"w-4 h-4 text-gray-400 transition-transform "+("credit_card"===x?"rotate-180":"")})]}),"credit_card"===x&&e.jsxs(i.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"border-t border-gray-200 p-3 space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-green-600 bg-green-50 p-2 rounded text-xs",children:[e.jsx(w,{className:"w-3 h-3"}),e.jsx("span",{className:"font-medium",children:"256-bit SSL korumalı"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Kart Numarası *"}),e.jsxs("div",{className:"relative",children:[e.jsx(v,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-3 h-3 text-gray-400"}),e.jsx("input",{type:"text",value:B.cardNumber,onChange:e=>{$("cardNumber",e.target.value.replace(/\D/g,"").replace(/(\d{4})(?=\d)/g,"$1 ").trim()),m("credit_card")},placeholder:"1234 5678 9012 3456",maxLength:19,className:"w-full pl-8 pr-3 py-2 text-sm border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors "+(A.cardNumber?"border-red-300 focus:border-red-500 focus:ring-red-200":"border-gray-300")})]}),A.cardNumber&&e.jsxs("div",{className:"flex items-center space-x-1 text-red-500 text-xs",children:[e.jsx(f,{className:"w-3 h-3"}),e.jsx("span",{children:A.cardNumber})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Tarih *"}),e.jsxs("div",{className:"relative",children:[e.jsx(d,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-3 h-3 text-gray-400"}),e.jsx("input",{type:"text",value:B.expiryDate,onChange:e=>$("expiryDate",(e=>{const s=e.replace(/\D/g,"");return s.length>=2?s.slice(0,2)+"/"+s.slice(2,4):s})(e.target.value)),placeholder:"MM/YY",maxLength:5,className:"w-full pl-8 pr-3 py-2 text-sm border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors "+(A.expiryDate?"border-red-300 focus:border-red-500 focus:ring-red-200":"border-gray-300")})]}),A.expiryDate&&e.jsxs("div",{className:"flex items-center space-x-1 text-red-500 text-xs",children:[e.jsx(f,{className:"w-3 h-3"}),e.jsx("span",{children:A.expiryDate})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"CVV *"}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-3 h-3 text-gray-400"}),e.jsx("input",{type:"text",value:B.cvv,onChange:e=>$("cvv",e.target.value.replace(/\D/g,"")),placeholder:"123",maxLength:4,className:"w-full pl-8 pr-3 py-2 text-sm border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors "+(A.cvv?"border-red-300 focus:border-red-500 focus:ring-red-200":"border-gray-300")})]}),A.cvv&&e.jsxs("div",{className:"flex items-center space-x-1 text-red-500 text-xs",children:[e.jsx(f,{className:"w-3 h-3"}),e.jsx("span",{children:A.cvv})]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Kart Sahibi *"}),e.jsxs("div",{className:"relative",children:[e.jsx(h,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-3 h-3 text-gray-400"}),e.jsx("input",{type:"text",value:B.cardName,onChange:e=>$("cardName",e.target.value.toUpperCase()),placeholder:"ADI SOYADI",className:"w-full pl-8 pr-3 py-2 text-sm border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors "+(A.cardName?"border-red-300 focus:border-red-500 focus:ring-red-200":"border-gray-300")})]}),A.cardName&&e.jsxs("div",{className:"flex items-center space-x-1 text-red-500 text-xs",children:[e.jsx(f,{className:"w-3 h-3"}),e.jsx("span",{children:A.cardName})]})]})]})]}),j.enabledMethods.bankTransfer&&e.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[e.jsxs("button",{type:"button",onClick:()=>u("bank_transfer"===x?null:"bank_transfer"),className:"w-full p-3 flex items-center justify-between text-left hover:bg-gray-50 rounded-lg transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-4 h-4 rounded-full border-2 "+("bank_transfer"===c?"border-green-500 bg-green-500":"border-gray-300"),children:"bank_transfer"===c&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-white m-0.5"})}),e.jsx(C,{className:"w-4 h-4 text-gray-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Havale/EFT"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Banka hesabına havale"})]})]}),e.jsx(r,{className:"w-4 h-4 text-gray-400 transition-transform "+("bank_transfer"===x?"rotate-180":"")})]}),"bank_transfer"===x&&e.jsxs(i.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"border-t border-gray-200 p-3 space-y-3",children:[e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded p-2",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(f,{className:"w-3 h-3 text-orange-600 mt-0.5"}),e.jsxs("div",{className:"text-xs text-orange-700",children:[e.jsx("p",{className:"font-medium",children:"Bilgi:"}),e.jsx("p",{children:"Havale sonrası rezervasyon onaylanır. Açıklama kısmına kodu yazın."})]})]})}),b&&b.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:"Hesap Bilgileri:"}),b.map((s,a)=>e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-3 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h5",{className:"font-semibold text-gray-900 text-sm",children:s.bankName}),e.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:"Aktif"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Hesap Sahibi:"}),e.jsx("p",{className:"text-gray-900",children:s.accountHolder})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"IBAN:"}),e.jsxs("div",{className:"flex items-center justify-between bg-white rounded p-2 mt-1",children:[e.jsx("p",{className:"text-gray-900 font-mono text-xs",children:s.iban}),e.jsx("button",{onClick:()=>{return e=s.iban,void navigator.clipboard.writeText(e);var e},className:"ml-2 p-1 hover:bg-gray-100 rounded transition-colors",title:"IBAN'ı kopyala",children:e.jsx(S,{className:"w-3 h-3 text-gray-600"})})]})]})]})]},a)),e.jsx("button",{onClick:()=>m("bank_transfer"),className:"w-full bg-green-600 text-white py-2 rounded hover:bg-green-700 transition-colors text-xs font-medium",children:"Havale Seç"})]})]})]}),j.enabledMethods.cash&&e.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[e.jsxs("button",{type:"button",onClick:()=>u("cash"===x?null:"cash"),className:"w-full p-3 flex items-center justify-between text-left hover:bg-gray-50 rounded-lg transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-4 h-4 rounded-full border-2 "+("cash"===c?"border-yellow-500 bg-yellow-500":"border-gray-300"),children:"cash"===c&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-white m-0.5"})}),e.jsx(T,{className:"w-4 h-4 text-gray-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Nakit"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Transfer günü ödeme"})]})]}),e.jsx(r,{className:"w-4 h-4 text-gray-400 transition-transform "+("cash"===x?"rotate-180":"")})]}),"cash"===x&&e.jsxs(i.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"border-t border-gray-200 p-3 space-y-3",children:[e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-3",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(z,{className:"w-3 h-3 text-yellow-600 mt-0.5"}),e.jsxs("div",{className:"text-xs text-yellow-700",children:[e.jsx("p",{className:"font-medium mb-1",children:"Koşullar:"}),e.jsxs("ul",{className:"space-y-1 text-xs",children:[e.jsx("li",{children:"• Transfer başında şoföre ödenecektir"}),e.jsx("li",{children:"• Tam para getiriniz"})]})]})]})}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-3",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2 text-xs",children:"Ödeme Detayları"}),e.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Tutar:"}),e.jsxs("span",{className:"font-bold",children:["€",s.totalPrice||0]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Zaman:"}),e.jsx("span",{children:"Transfer başında"})]})]})]}),e.jsx("button",{onClick:()=>m("cash"),className:"w-full bg-yellow-600 text-white py-2 rounded hover:bg-yellow-700 transition-colors text-xs font-medium",children:"Nakit Seç"})]})]})]}),e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded p-2",children:e.jsxs("div",{className:"text-center space-y-1",children:[e.jsxs("div",{className:"flex justify-center items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-1 text-green-600",children:[e.jsx(w,{className:"w-3 h-3"}),e.jsx("span",{className:"text-xs font-medium",children:"SSL"})]}),e.jsxs("div",{className:"flex items-center space-x-1 text-blue-600",children:[e.jsx(k,{className:"w-3 h-3"}),e.jsx("span",{className:"text-xs font-medium",children:"Güvenli"})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Ödeme bilgileriniz güvende."})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-3 pt-3",children:[e.jsxs("button",{onClick:n,disabled:o,className:"w-full sm:w-auto order-2 sm:order-1 bg-gray-100 text-gray-700 px-5 py-2.5 rounded-lg hover:bg-gray-200 transition-colors flex items-center justify-center space-x-2 disabled:opacity-50 font-medium text-sm",children:[e.jsx(N,{className:"w-4 h-4"}),e.jsx("span",{children:"Geri"})]}),e.jsx("button",{onClick:async()=>{if((()=>{if("credit_card"!==c)return!0;const e={};if(B.cardNumber.trim()?B.cardNumber.replace(/\s/g,"").length<16&&(e.cardNumber="Kart numarası 16 haneli olmalıdır"):e.cardNumber="Kart numarası zorunludur",B.expiryDate.trim()){const[s,a]=B.expiryDate.split("/"),t=new Date,r=t.getFullYear()%100,l=t.getMonth()+1;!s||!a||s<1||s>12?e.expiryDate="Geçerli bir tarih giriniz (MM/YY)":(parseInt(a)<r||parseInt(a)===r&&parseInt(s)<l)&&(e.expiryDate="Kartın süresi geçmiş")}else e.expiryDate="Son kullanma tarihi zorunludur";return B.cvv.trim()?(B.cvv.length<3||B.cvv.length>4)&&(e.cvv="CVV 3-4 haneli olmalıdır"):e.cvv="CVV zorunludur",B.cardName.trim()?B.cardName.trim().length<2&&(e.cardName="İsim en az 2 karakter olmalıdır"):e.cardName="Kart üzerindeki isim zorunludur",_(e),0===Object.keys(e).length})()){t({paymentMethod:c,creditCardInfo:"credit_card"===c?B:null});try{const e={customerPhone:s.personalInfo?.phone,reservationNumber:s.reservationNumber||"TMP-"+Date.now(),totalAmount:s.pricing?.totalPrice||s.totalPrice,paymentMethod:P(c)};(await H.sendPaymentConfirmation(e)).success}catch(e){}l()}},disabled:o||!c,className:"w-full sm:w-auto order-1 sm:order-2 bg-blue-600 text-white px-5 py-2.5 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2 disabled:opacity-50 disabled:bg-gray-400 font-medium text-sm",children:o?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"İşleniyor..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(a,{className:"w-4 h-4"}),e.jsx("span",{children:"Rezervasyon Tamamla"})]})})]})]})},O=()=>{const s=B(),[a,r]=R.useState(1),[l,n]=R.useState(!1),[o,c]=R.useState({tripType:"one-way",pickupLocation:null,dropoffLocation:null,date:"",time:"",returnDate:"",returnTime:"",passengerCount:1,baggageCount:1,selectedVehicle:null,routeInfo:null,totalPrice:0,personalInfo:{firstName:"",lastName:"",phone:"",email:"",address:"",flightNumber:"",flightTime:"",specialRequests:""},paymentMethod:"credit_card",creditCardInfo:null,acceptedTerms:!1});R.useEffect(()=>{const e=localStorage.getItem("quickBookingData");if(e)try{const s=JSON.parse(e);c(e=>({...e,...s})),s.currentStep&&r(s.currentStep),localStorage.removeItem("quickBookingData")}catch(s){}},[]);const d=[{id:1,name:"Güzergah",component:$,icon:t},{id:2,name:"Bilgiler",component:V,icon:h},{id:3,name:"Ödeme",component:F,icon:v}],m=d[a-1]?.component;return e.jsx("div",{className:"min-h-screen bg-gray-50 py-4 px-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col items-center space-y-3 mb-6",children:[e.jsx("div",{className:"flex items-center justify-center space-x-1 sm:space-x-4 md:space-x-8",children:d.map((s,t)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`\n                  flex items-center justify-center w-8 h-8 md:w-10 md:h-10 rounded-full transition-all duration-300\n                  ${a>s.id?"bg-green-500 text-white shadow-lg scale-105":a===s.id?"bg-blue-600 text-white shadow-lg scale-110":"bg-white text-gray-500 border-2 border-gray-300"}\n                `,children:a>s.id?e.jsx(L,{className:"w-4 h-4 md:w-5 md:h-5"}):e.jsx(s.icon,{className:"w-4 h-4 md:w-5 md:h-5"})}),t<d.length-1&&e.jsx("div",{className:`\n                    w-8 sm:w-12 lg:w-20 h-0.5 ml-2 sm:ml-4 transition-colors\n                    ${a>s.id?"bg-green-500":"bg-gray-300"}\n                  `})]},s.id))}),e.jsx("div",{className:"flex items-center justify-center space-x-8 sm:space-x-16 md:space-x-24",children:d.map(s=>e.jsx("span",{className:`\n                text-xs sm:text-sm font-medium transition-colors text-center\n                ${a>=s.id?"text-gray-900":"text-gray-500"}\n              `,children:s.name},s.id))})]}),e.jsx(i.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"bg-white rounded-lg shadow-sm p-6",children:m&&e.jsx(m,{bookingData:o,updateBookingData:e=>{c(s=>({...s,...e}))},onNext:()=>{a<d.length&&(r(e=>e+1),window.scrollTo({top:0,behavior:"smooth"}))},onBack:()=>{a>1&&(r(e=>e-1),window.scrollTo({top:0,behavior:"smooth"}))},onComplete:async()=>{n(!0);try{const e=`RES${Date.now()}`,a={...o,id:e,status:"confirmed"};s("/booking-confirmation",{state:{bookingData:a}})}catch(e){alert("Rezervasyon hazırlanırken bir hata oluştu. Lütfen tekrar deneyin.")}finally{n(!1)}},isLoading:l})},a)]})})};export{O as default};
